import{_ as a,a as s,a2 as t,o}from"./chunks/framework.DAlL-BGO.js";const h=JSON.parse('{"title":"","description":"","frontmatter":{"lastUpdated":"2023-12-18 22:22"},"headers":[],"relativePath":"pages/Docker/Docker容器目录迁移.md","filePath":"pages/Docker/Docker容器目录迁移.md","lastUpdated":1733806965000}'),i={name:"pages/Docker/Docker容器目录迁移.md"};function l(c,e,d,p,n,r){return o(),s("div",null,e[0]||(e[0]=[t(`<h2 id="背景" tabindex="-1">背景 <a class="header-anchor" href="#背景" aria-label="Permalink to &quot;背景&quot;">​</a></h2><p>docker容器太多，导致所在磁盘空间满了，将<code>/var/lib/docker</code>目录迁移到其它的位置</p><h2 id="迁移步骤" tabindex="-1">迁移步骤 <a class="header-anchor" href="#迁移步骤" aria-label="Permalink to &quot;迁移步骤&quot;">​</a></h2><ul><li>关闭docker服务</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ systemctl stop docker</span></span></code></pre></div><ul><li>备份文件</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ mv /var/lib/docker /var/lib/docker_bak</span></span></code></pre></div><ul><li>迁移文件到盘</li></ul><p>本次是迁移到目录 <code>/home/disk2/docker</code>，复制文件需要使用参数<code>-a</code>, 避免一些文件权限问题导致服务启动出错，或者容器无法启动</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ cd /home/disk2</span></span>
<span class="line"><span>$ cp -a /var/lib/docker_bak docker # 或者 cp -pr /var/lib/docker_bak docker</span></span></code></pre></div><blockquote><p><code>-a</code> 相当于 <code>-pdr</code> 参数pdr分别为：保留权限，复制软链接本身，递归复制</p></blockquote><ul><li>创建软链接</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ ln -s /home/disk2/docker /var/lib/docker</span></span></code></pre></div><ul><li>重启docker服务</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ systemctl start docker</span></span></code></pre></div><ul><li>检查并删除备份文件</li></ul><p>检查没有问题之后，将备份目录<code>/var/lib/docker_bak</code>删除或者迁移到其它位置备份。</p>`,17)]))}const u=a(i,[["render",l]]);export{h as __pageData,u as default};
