import{_ as a,a as e,a2 as n,o as p}from"./chunks/framework.DAlL-BGO.js";const v=JSON.parse('{"title":"","description":"","frontmatter":{"lastUpdated":"2023-12-18 22:22"},"headers":[],"relativePath":"pages/安装手册/CentOS8安装并配置-VNC-Server.md","filePath":"pages/安装手册/CentOS8安装并配置-VNC-Server.md","lastUpdated":1733806965000}'),t={name:"pages/安装手册/CentOS8安装并配置-VNC-Server.md"};function i(l,s,c,r,o,d){return p(),e("div",null,s[0]||(s[0]=[n(`<h2 id="_1-安装桌面环境" tabindex="-1">1 安装桌面环境 <a class="header-anchor" href="#_1-安装桌面环境" aria-label="Permalink to &quot;1 安装桌面环境&quot;">​</a></h2><p>如果桌面环境未安装时，需要提前安装好。已安装请忽略</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ sudo dnf groupinstall &quot;Server with GUI&quot;</span></span></code></pre></div><h2 id="_2-安装vnc-server" tabindex="-1">2 安装VNC Server <a class="header-anchor" href="#_2-安装vnc-server" aria-label="Permalink to &quot;2 安装VNC Server&quot;">​</a></h2><p>vnc版本号</p><blockquote><p>Xvnc TigerVNC 1.9.0 - built Apr 23 2020 14:52:39</p></blockquote><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ sudo dnf install tigervnc-server tigervnc-server-module -y</span></span></code></pre></div><h2 id="_3-配置vnc登录密码" tabindex="-1">3 配置VNC登录密码 <a class="header-anchor" href="#_3-配置vnc登录密码" aria-label="Permalink to &quot;3 配置VNC登录密码&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ vncpasswd</span></span></code></pre></div><p>输入并确认密码</p><blockquote><p>Password: Verify: Would you like to enter a view-only password (y/n)? n A view-only password is not used</p></blockquote><h2 id="_4-添加服务并设置开机自启" tabindex="-1">4 添加服务并设置开机自启 <a class="header-anchor" href="#_4-添加服务并设置开机自启" aria-label="Permalink to &quot;4 添加服务并设置开机自启&quot;">​</a></h2><p>根据登录用户放到对应的用户目录下</p><ul><li>创建目录</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ mkdir -p ~/.config/systemd/user</span></span></code></pre></div><ul><li>复制配置文件</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ cp /usr/lib/systemd/user/vncserver@.service ~/.config/systemd/user/</span></span></code></pre></div><p><code>vncserver@.service</code> 配置文件内容如下</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span>Description=Remote desktop service (VNC)</span></span>
<span class="line"><span>After=syslog.target network.target</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>Type=forking</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ExecStartPre=/bin/sh -c &#39;/usr/bin/vncserver -kill %i &gt; /dev/null 2&gt;&amp;1 || :&#39;</span></span>
<span class="line"><span>ExecStart=/usr/bin/vncserver %i</span></span>
<span class="line"><span>ExecStop=/usr/bin/vncserver -kill %i</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Restart=on-success</span></span>
<span class="line"><span>RestartSec=15</span></span>
<span class="line"><span></span></span>
<span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy=default.target</span></span></code></pre></div><ul><li>重新加载配置</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ systemctl --user daemon-reload</span></span></code></pre></div><ul><li>启动并添加开机自启服务</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ systemctl --user enable vncserver@:1.service --now</span></span></code></pre></div><ul><li>设置用户服务在系统启动时允许（不是用户登录时）</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ loginctl enable-linger</span></span></code></pre></div><p>如果不是当前用户的话，例如设置 <code>zqyu</code> 用户，设置如下</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ loginctl enable-linger zqyu</span></span></code></pre></div><ul><li>验证运行状态</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ systemctl --user status vncserver@:1.service</span></span></code></pre></div><p>运行正常如下</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>● vncserver@:1.service - Remote desktop service (VNC)</span></span>
<span class="line"><span>   Loaded: loaded (/home/zqyu/.config/systemd/user/vncserver@.service; enabled; vendor preset: enabled)</span></span>
<span class="line"><span>   Active: active (running) since Thu 2020-11-19 16:29:17 CST; 21min ago</span></span>
<span class="line"><span>  Process: 2893 ExecStart=/usr/bin/vncserver :1 (code=exited, status=0/SUCCESS)</span></span>
<span class="line"><span>  Process: 2887 ExecStartPre=/bin/sh -c /usr/bin/vncserver -kill :1 &gt; /dev/null 2&gt;&amp;1 || : (code=exited, status=0/SUCCESS)</span></span>
<span class="line"><span>    Tasks: 242 (limit: 23810)</span></span>
<span class="line"><span>   Memory: 489.1M</span></span>
<span class="line"><span>   CGroup: /user.slice/user-0.slice/user@0.service/vncserver.slice/vncserver@:1.service</span></span>
<span class="line"><span>  .......</span></span></code></pre></div><h2 id="_5-防火墙开放" tabindex="-1">5 防火墙开放 <a class="header-anchor" href="#_5-防火墙开放" aria-label="Permalink to &quot;5 防火墙开放&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>$ sudo firewall-cmd --add-service=vnc-server --permanent</span></span>
<span class="line"><span>$ sudo firewall-cmd --reload</span></span></code></pre></div><h2 id="_6-待解决" tabindex="-1">6 待解决 <a class="header-anchor" href="#_6-待解决" aria-label="Permalink to &quot;6 待解决&quot;">​</a></h2><p>锁屏后重新登录时，出现错误&quot;Authentication failed(认证失败)&quot; ，并一直刷新无法输入的<a href="https://bugzilla.redhat.com/show_bug.cgi?id=1671714" target="_blank" rel="noreferrer">情况</a>，待解决</p>`,35)]))}const h=a(t,[["render",i]]);export{v as __pageData,h as default};
